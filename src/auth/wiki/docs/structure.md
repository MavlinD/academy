Внутре скрыт [многопоточный, многопроцессорный и асинхронный сервер](https://fastapi.tiangolo.com/).  
Основной фреймворк [FastAPI].

:fontawesome-regular-star:
 **Модель пользователя (User) имеет атрибуты:**

1. id (уникален, неизменяем)  
2. username (уникален, неизменяем)  
3. email (уникален, неизменяем)  
4. password  
5. first name  
6. last name  
7. is_superuser  
8. is_active  
9. is_verified  

Может быть расширена.

:fontawesome-regular-star:
**Модель группы (Group) имеет атрибуты:**

1. id (уникален, неизменяем)  
2. groupname (уникален, неизменяем)  
3. slug (человеко-понятный урл, уникален, неизменяем)  

:fontawesome-solid-bolt:
Для взаимодействия с БД используется [SQLAlchemy].  

Список поддерживаемых [СУБД и диалектов](https://docs.sqlalchemy.org/en/20/dialects/index.html).   
Однако везде есть нюансы, например SQLite не поддерживает регистронезависимый поиск, а перенос данных в другую СУБД является нетривиальной задачей.

### Управление состоянием БД

:fontawesome-solid-bolt:
Миграциями БД управляет [Alembic]:

Но в данном случае стандартные команды alembic отдаются через скрипт-обертку:
```shell
python staff.py alembic upgrade head
python staff.py alembic revision -m "init" --autogenerate
# и т.д.
```

### Управление потоками
```sh
# определяет кол-во потоков, рекомендуется максимум 2-4 потока на ядро 
>>WEB_CONCURRENCY
```
!!! info "Самый полный и свежий список переменных сервиса можно найти в файле `api/app/core/config.py`."

### Верификация токенов
Ниже приведен `действующий ключ`, (в документации мог устареть) можно на нём верифицировать полученные токены, при этом нужно учитывать то обстоятельство, что изменения в привилегиях пользователя будут отражены только тогда, когда будет получен обновленный токен, по умолчанию время актуальности токена составляет 15 мин.  
Чтобы получить сразу обновленное состояние пользователя, можно верифицировать токен обратившись в сервис с соответствующим запросом. 

(чтобы убедится в актуальности ключа выполните `GET /pub-key`)
```shell
# pub-key.pem
{% 
include '../../../../dbs/pub-key.pem'
%}
```

### Интеграция со сторонними системами
```shell
>>SENTRY_DSN
```
для интеграции с [Sentry] укажите переменную выше 

{% 
include 'links.md'
rewrite-relative-urls=false
%}
